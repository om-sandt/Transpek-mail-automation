{% extends "base.html" %}

{% block title %}Submit Request - Approval Workflow{% endblock %}

{% block content %}
<div class="row justify-content-center">
    <div class="col-md-8">
        <div class="card">
            <div class="card-header">
                <h3 class="mb-0">
                    <i class="fas fa-plus-circle"></i> Submit New Approval Request
                </h3>
            </div>
            <div class="card-body">
                <form method="POST" action="{{ url_for('submit') }}">
                    <div class="mb-3">
                        <label for="data" class="form-label">
                            <i class="fas fa-file-text"></i> Request Data
                        </label>
                        <textarea 
                            class="form-control" 
                            id="data" 
                            name="data" 
                            rows="8" 
                            placeholder="Enter the details of your approval request here..."
                            required
                        ></textarea>
                        <div class="form-text">
                            Provide all relevant information that needs to be reviewed and approved.
                        </div>
                    </div>

                    <div class="mb-3">
                        <label for="approver_email" class="form-label">
                            <i class="fas fa-envelope"></i> Approver Email
                        </label>
                        <input 
                            type="email" 
                            class="form-control" 
                            id="approver_email" 
                            name="approver_email" 
                            placeholder="approver@example.com"
                            required
                        >
                        <div class="form-text">
                            The email address of the person who will review and approve/reject this request.
                        </div>
                    </div>

                    <div class="d-grid gap-2 d-md-flex justify-content-md-end">
                        <a href="{{ url_for('index') }}" class="btn btn-secondary me-md-2">
                            <i class="fas fa-times"></i> Cancel
                        </a>
                        <button type="submit" class="btn btn-primary">
                            <i class="fas fa-paper-plane"></i> Submit Request
                        </button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Information Card -->
        <div class="card mt-4">
            <div class="card-header bg-info text-white">
                <h5 class="mb-0">
                    <i class="fas fa-info-circle"></i> How it works
                </h5>
            </div>
            <div class="card-body">
                <div class="row">
                    <div class="col-md-4 text-center">
                        <i class="fas fa-edit fa-2x text-primary mb-2"></i>
                        <h6>1. Submit Request</h6>
                        <p class="small text-muted">Fill out the form above with your request details and approver's email.</p>
                    </div>
                    <div class="col-md-4 text-center">
                        <i class="fas fa-envelope fa-2x text-warning mb-2"></i>
                        <h6>2. Email Notification</h6>
                        <p class="small text-muted">The approver will receive an email with a PDF attachment and action buttons.</p>
                    </div>
                    <div class="col-md-4 text-center">
                        <i class="fas fa-check-circle fa-2x text-success mb-2"></i>
                        <h6>3. Approval Process</h6>
                        <p class="small text-muted">The approver can approve or reject the request with optional comments.</p>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
// Auto-resize textarea
document.getElementById('data').addEventListener('input', function() {
    this.style.height = 'auto';
    this.style.height = (this.scrollHeight) + 'px';
});

// Character counter
document.getElementById('data').addEventListener('input', function() {
    const maxLength = 5000;
    const currentLength = this.value.length;
    const remaining = maxLength - currentLength;
    
    let counter = document.getElementById('char-counter');
    if (!counter) {
        counter = document.createElement('div');
        counter.id = 'char-counter';
        counter.className = 'form-text';
        this.parentNode.appendChild(counter);
    }
    
    if (currentLength > maxLength * 0.9) {
        counter.className = 'form-text text-warning';
    } else {
        counter.className = 'form-text';
    }
    
    counter.textContent = `${currentLength} characters (${remaining} remaining)`;
});
</script>
{% endblock %} 